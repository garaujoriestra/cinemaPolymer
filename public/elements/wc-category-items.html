<link rel="import" href="wc-item.html">
<dom-module id="wc-category-items">
  <template>
    <style >
      #wrapper-category-items{
        width: var(--anchoMaximo);
        transform: var(--translate,translate3d(0px, 0px, 0px));
        transition: 1s;
      }
      #container-category-items{
          max-width: 100%;
          display: inline-block;
          overflow: hidden;
      }
    </style>

    <iron-ajax
    auto
      url="/api/items/{{name}}"
      handle-as="json"
      on-response="load"
      debounce-duration="500"></iron-ajax>

     <div class="container flex-center-justified">
        <h3>{{name}}</h3>
    </div>
    <div class="col-sm-1">
      <button on-tap="onTapLeft">Left</button>
    </div>
    <div class="col-sm-10">
      <div id="container-category-items">
        <div id="wrapper-category-items">

          <template
               is="dom-repeat" 
               items="{{items}}" 
               as="item">
                    <wc-item class=""
                      name="{{item.nombre}}"
                      category="{{item.nameSub}}"
                      image="{{item.imagen}}"
                      price ="{{item.precio}}">
                    </wc-item>
            </template>
        </div>
      </div>
    </div>
    <div class="col-sm-1">
      <button on-tap="onTapRight">Right</button>
   </div>
  </template>
  <script>
    HTMLImports.whenReady(function () {
      var anchoMaximo = 0;
      var move = 0;
      Polymer({
        
        is: 'wc-category-items',
        properties : {
            items : {
                type     : Array,
                value    : function () { return []; },
                observer: 'whenItems',
                notify: true
            },
            name : {
              type:String,
              value: "",
              observer: 'whenName',
              notify: true
            }
        },
        whenItems: function(){
          anchoMaximo = this.items.length * 200;
          this.customStyle['--anchoMaximo'] = anchoMaximo + 'px';
          this.updateStyles();
        },
        whenName: function(){
          
        },
        ready: function(){
          this.async(function(){
            anchoMaximo = this.items.length * 200;
            this.customStyle['--anchoMaximo'] = anchoMaximo + 'px';
            this.updateStyles();
          }, 500);
         
        },
        load : function (data) {
          console.log("WhenName",data.detail.response.rows);
          this.items = data.detail.response.rows;
        },
        onTapLeft : function(){
          if(move < 0){
            move = move + 200;
          }else{
            move = 0;
          }
          this.customStyle['--translate'] = 'translate3d('+move+'px, 0px, 0px)';
          this.updateStyles();
        },

        onTapRight: function(){
          move = (move - 200);
          this.customStyle['--translate'] = 'translate3d('+move+'px, 0px, 0px)';
          this.updateStyles();
        }
      });
    });
 </script>
</dom-module>